@using System.Globalization
@model FirstWebApplication.Models.Obstacle.CompleteQuickRegViewModel

@{
    ViewData["Title"] = "Complete Registration";
}

@section Head {
    <link rel="stylesheet" href="~/lib/leaflet/leaflet.css" />
    <link rel="stylesheet" href="~/css/pilot/fullregister.css" asp-append-version="true" />
}

<div class="registration-grid">
    <div id="map"
         data-geometry="@Model.ObstacleGeometry"
         data-regid="@Model.ObstacleId"></div>

    <div class="registration-form">
        <h2 class="text-2xl font-bold mb-2">Complete Registration #@Model.ObstacleId</h2>
        <p class="text-gray-600 mb-4">
            Du kan justere posisjonen (üìç) p√• kartet f√∏r du fyller ut detaljene.
        </p>

        <div class="alert alert-info" role="alert">
            Opprinnelig registrert: @Model.RegisteredDate.ToString("dd.MM.yyyy HH:mm")
        </div>

        <form asp-action="CompleteQuickRegister" method="post">
            <input type="hidden" asp-for="ObstacleId" />

            <input type="hidden" asp-for="ObstacleGeometry" id="obstacleGeometryInput" />
            <span asp-validation-for="ObstacleGeometry" class="text-danger"></span>

            <div class="form-group">
                <label asp-for="ObstacleType">Obstacle Type:</label>
                <select asp-for="ObstacleType" class="form-control" id="obstacleTypeSelect">
                    <option value="">-- Select Type --</option>
                    <option value="Mast">Mast</option>
                    <option value="Tower">Tower</option>
                    <option value="Power Line">Power Line</option>
                    <option value="Wind Turbine">Wind Turbine</option>
                    <option value="Building">Building</option>
                    <option value="Crane">Crane</option>
                    <option value="Bridge">Bridge</option>
                    <option value="Other">Other</option>
                </select>
                <span asp-validation-for="ObstacleType" class="text-danger"></span>
            </div>

            <div class="form-group" id="customTypeGroup" style="display: none;">
                <label for="customTypeName">Specify Type:</label>
                <input type="text" name="CustomObstacleType" id="customTypeName" class="form-control" placeholder="Enter custom obstacle type..." />
            </div>

            <div class="form-group">
                <label asp-for="ObstacleHeight">Height (meters): *</label>
                <input asp-for="ObstacleHeight" type="number" step="0.1" class="form-control" placeholder="E.g., 50" />
                <span asp-validation-for="ObstacleHeight" class="text-danger"></span>
            </div>

            <div class="form-group">
                <label asp-for="ObstacleDescription">Description: *</label>
                <textarea asp-for="ObstacleDescription" class="form-control" rows="4" placeholder="Describe the obstacle..."></textarea>
                <span asp-validation-for="ObstacleDescription" class="text-danger"></span>
            </div>

            <button type="submit" class="btn btn-primary w-100 mt-4">Fullf√∏r Registrering</button>
            <a asp-action="MyRegistrations" class="btn btn-secondary w-100">Avbryt</a>
        </form>
    </div>
</div>

@section Scripts {
    <script src="~/lib/leaflet/leaflet.js"></script>
    <script src="~/js/pilot/complete-quick-register.js" asp-append-version="true"></script>
}